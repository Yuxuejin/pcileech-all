# 用户特征配置说明

## 🎯 **最小改动防特征方案**

**保持COE不变，只修改TLP寄存器响应值**

## 🔧 **使用方法**

### 修改用户参数
在 `src/pcileech_tlps128_bar_controller.sv` 文件顶部找到：

```systemverilog
// 用户特征参数 - 修改这些值来防止特征识别
parameter [7:0] USER_SIGNATURE = 8'h00;  // 用户特征签名 (0x00-0xFF)
parameter [3:0] USER_VARIANT = 4'h0;     // 用户变体 (0x0-0xF)
```

### 不同用户使用不同值：

```systemverilog
// 用户1
parameter [7:0] USER_SIGNATURE = 8'h12;
parameter [3:0] USER_VARIANT = 4'h3;

// 用户2  
parameter [7:0] USER_SIGNATURE = 8'h34;
parameter [3:0] USER_VARIANT = 4'h7;

// 用户3
parameter [7:0] USER_SIGNATURE = 8'h56;
parameter [3:0] USER_VARIANT = 4'hA;

// 用户4
parameter [7:0] USER_SIGNATURE = 8'h78;
parameter [3:0] USER_VARIANT = 4'hE;
```

## 🔄 **驱动程序差异**

### Netwtw10 vs Netwtw08 关键差异：
- **CSR_GP_CNTRL_REG**: Netwtw10期望 `0x01000000`，Netwtw08期望 `0x08000000`
- **CSR_GP_STATUS_REG**: Netwtw10期望 `0x00000000`，Netwtw08期望 `0x00000001`

### 当前配置：
代码已自动适配 **Netwtw10** 驱动程序要求。

## ✅ **优势**

1. **保持驱动兼容**: 设备ID不变，驱动正常工作
2. **防止特征识别**: 寄存器值不同，无法关联
3. **最小改动**: 只需修改2个参数
4. **简单部署**: 编译烧录即可
5. **自动适配**: 支持Netwtw10和Netwtw08驱动

## 🔍 **安全的特征差异效果**

### 关键寄存器保持原值 (确保驱动兼容)：
- **CSR_HW_IF_CONFIG_REG**: 始终 0x00800000 (不变)
- **CSR_GP_CNTRL_REG**: 始终 0x01000000 (不变)
- **CSR_UCODE_LOAD_STATUS**: 始终 0x00000001 (不变)

### 安全位置的用户特征：
- **CSR_GP_DRIVER_REG**: 0x00000001 vs 0x00000002 (低8位)
- **CSR_FUNC_SCRATCH_REG**: 0x01010101 vs 0x02020202 (全部)
- **用户特征寄存器 (0x200-0x208)**: 完全不同的值

### 驱动程序看到：
- 关键功能寄存器相同 → 正常加载驱动 ✅
- 非关键寄存器不同 → 无法特征关联 ✅
- 最佳平衡：兼容性 + 防特征 ✅

## 📋 **部署步骤**

1. **修改参数**: 改变USER_SIGNATURE和USER_VARIANT
2. **编译固件**: 使用Vivado编译
3. **烧录测试**: 确认绿灯亮起
4. **验证驱动**: 检查设备管理器无错误

## ⚠️ **注意事项**

- 不要使用相同的参数值
- 保持设备ID (COE文件) 不变
- 测试每个配置的驱动兼容性

这样既保持了驱动兼容性，又实现了防特征识别！
